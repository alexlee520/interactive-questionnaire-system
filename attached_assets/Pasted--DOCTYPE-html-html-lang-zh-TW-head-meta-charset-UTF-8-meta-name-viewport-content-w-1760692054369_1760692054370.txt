<!DOCTYPE html>
<html lang="zh-TW">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width,initial-scale=1.0" />
<title>åˆä½œå¤¥ä¼´å•å·ï¼ˆå„ªåŒ–ç‰ˆï¼‰</title>
<style>
  :root {
    --bg: #ffffff;
    --text: #111827;
    --muted: #6b7280;
    --panel: #f7f8fa;
    --panel-strong: #f2f4f7;
    --border: #e5e7eb;
    --border-strong: #d1d5db;
    --accent: #06C167;
    --accent-600: #05a557;
    --accent-100: #e9fbf2;
    --error: #ef4444;
    --error-focus-ring: rgba(239,68,68,0.15);
    --focus-ring: rgba(6,193,103,0.22);
    --shadow-sm: 0 1px 3px rgba(16,24,40,0.08);
    --shadow-md: 0 6px 18px rgba(16,24,40,0.10);
    --particle-opacity: 0.12;
  }
  [data-theme="dark"] {
    --bg: #141414;
    --text: #ffffff;
    --muted: #B3B3B3;
    --panel: #282828;
    --panel-strong: #2f2f2f;
    --border: #3a3a3a;
    --border-strong: #4a4a4a;
    --accent: #06C167;
    --accent-600: #05a557;
    --accent-100: rgba(6,193,103,0.15);
    --error: #f87171;
    --error-focus-ring: rgba(248,113,113,0.2);
    --focus-ring: rgba(6,193,103,0.25);
    --shadow-sm: 0 4px 12px rgba(0,0,0,0.3);
    --shadow-md: 0 8px 24px rgba(0,0,0,0.4);
    --particle-opacity: 0.15;
  }

  * { margin: 0; padding: 0; box-sizing: border-box; }
  html, body { height: 100%; }
  body {
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, 'PingFang TC', 'Microsoft JhengHei', sans-serif;
    background: var(--bg);
    color: var(--text);
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
    overflow-x: hidden;
    transition: background 0.3s ease, color 0.3s ease;
  }

  .theme-toggle {
    position: fixed; top: 20px; right: 20px; z-index: 1001;
    background: var(--panel);
    border: 2px solid var(--border);
    border-radius: 50%;
    width: 48px; height: 48px;
    display: flex; align-items: center; justify-content: center;
    cursor: pointer; transition: all 0.3s ease; box-shadow: var(--shadow-sm);
  }
  .theme-toggle:hover { transform: scale(1.1); box-shadow: var(--shadow-md); }
  .theme-toggle:focus-visible { outline: 2px solid var(--accent); outline-offset: 2px; }
  .theme-toggle svg { width: 24px; height: 24px; stroke: var(--text); fill: none; stroke-width: 2; stroke-linecap: round; stroke-linejoin: round; }
  .theme-toggle .moon-icon { display: none; }
  [data-theme="dark"] .theme-toggle .sun-icon { display: none; }
  [data-theme="dark"] .theme-toggle .moon-icon { display: block; }

  .particles-container { position: fixed; inset: 0; pointer-events: none; opacity: var(--particle-opacity); z-index: 0; }
  .particle { position: absolute; width: 3px; height: 3px; background: var(--accent); border-radius: 50%; animation: float 18s linear infinite; }
  @keyframes float { 0%{transform:translate(0,0);opacity:0} 10%{opacity:.9} 90%{opacity:.9} 100%{transform:translate(80px,-90vh);opacity:0} }

  .progress-bar { position: fixed; top: 0; left: 0; height: 4px; width: 0%; background: var(--accent); box-shadow: 0 0 10px rgba(6,193,103,0.35); transition: width 0.3s ease; z-index: 1000; }

  .container { position: relative; z-index: 1; min-height: 100vh; display: flex; align-items: center; justify-content: center; padding: 64px 20px 72px; }

  .question-container { width: 100%; max-width: 760px; opacity: 0; transform: translateY(24px); transition: all 0.45s ease; display: none; }
  .question-container.active { display: block; opacity: 1; transform: translateY(0); }

  .question-number { color: var(--muted); font-size: .9rem; margin: 0 0 12px; font-weight: 600; letter-spacing: .02em; }
  .question { color: var(--text); font-size: 2.1rem; line-height: 1.3; font-weight: 800; margin: 0 0 18px; }
  .subtitle { color: var(--muted); font-size: 1.075rem; line-height: 1.7; margin: 0 0 28px; }

  .hero-icon { width: 120px; height: 120px; margin: 0 auto 20px; background: var(--accent-100); border: 2px solid var(--accent); border-radius: 20px; display: flex; align-items: center; justify-content: center; box-shadow: var(--shadow-sm); }
  .hero-icon svg { width: 60px; height: 60px; stroke: var(--accent); fill: none; stroke-width: 2; stroke-linecap: round; stroke-linejoin: round; }

  .input-field { width: 100%; background: var(--bg); border: 2px solid var(--border); color: var(--text); font-size: 1.05rem; padding: 16px 18px; border-radius: 10px; outline: none; transition: border-color .2s, box-shadow .2s; box-shadow: var(--shadow-sm); }
  .input-field::placeholder { color: var(--muted); opacity: .6; }
  .input-field:focus { border-color: var(--accent); box-shadow: 0 0 0 6px var(--focus-ring); }
  .input-field.invalid { border-color: var(--error); }
  .input-field.invalid:focus { box-shadow: 0 0 0 6px var(--error-focus-ring); }

  .error-message { color: var(--error); font-size: .9rem; margin-top: 8px; font-weight: 500; display: none; }
  .error-message.visible { display: block; animation: fadeIn 0.3s ease; }

  .options { display: grid; gap: 14px; }
  .option { background: var(--bg); border: 2px solid var(--border); color: var(--text); padding: 18px 22px; border-radius: 12px; cursor: pointer; display: flex; align-items: center; gap: 14px; font-weight: 600; transition: transform .18s ease, box-shadow .18s ease, border-color .18s ease; box-shadow: var(--shadow-sm); }
  .option:hover { transform: translateY(-2px); box-shadow: var(--shadow-md); border-color: var(--border-strong); }
  .option:focus-within { border-color: var(--accent); box-shadow: 0 0 0 4px var(--focus-ring); }
  .option.selected { background: var(--accent-100); border-color: var(--accent); box-shadow: var(--shadow-md); }
  .option-letter { width: 34px; height: 34px; border-radius: 8px; background: var(--panel); color: var(--text); display: flex; align-items: center; justify-content: center; font-weight: 800; font-size: .9rem; flex-shrink: 0; }

  .checkbox-group { display: grid; gap: 12px; }
  .checkbox-option { background: var(--bg); border: 2px solid var(--border); padding: 14px 18px; border-radius: 12px; display: flex; align-items: center; gap: 12px; font-weight: 600; cursor: pointer; transition: transform .18s ease, box-shadow .18s ease, border-color .18s ease; box-shadow: var(--shadow-sm); }
  .checkbox-option:hover { transform: translateY(-2px); box-shadow: var(--shadow-md); border-color: var(--border-strong); }
  .checkbox-option:focus-within { border-color: var(--accent); box-shadow: 0 0 0 4px var(--focus-ring); }
  .checkbox-option.selected { background: var(--accent-100); border-color: var(--accent); }
  .checkbox-box { width: 24px; height: 24px; border: 2px solid var(--muted); border-radius: 6px; display: flex; align-items: center; justify-content: center; transition: all .18s ease; background: var(--bg); }
  .checkbox-option.selected .checkbox-box { background: var(--accent); border-color: var(--accent); }
  .checkbox-box::after { content: 'âœ“'; color: #fff; font-weight: 800; font-size: .95rem; display: none; }
  .checkbox-option.selected .checkbox-box::after { display: block; animation: checkmark .3s ease; }
  @keyframes checkmark { 0%{transform:scale(0)} 50%{transform:scale(1.2)} 100%{transform:scale(1)} }

  .controls { margin-top: 26px; display: flex; gap: 12px; flex-wrap: wrap; }
  .btn { padding: 14px 22px; border: none; border-radius: 10px; font-size: 1rem; font-weight: 800; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 10px; transition: transform .15s ease, box-shadow .2s ease, background .2s ease, opacity .2s ease; }
  .btn:focus-visible { outline: 2px solid var(--accent); outline-offset: 2px; }
  .btn-primary { background: var(--accent); color: #fff; flex: 1; box-shadow: var(--shadow-sm); }
  .btn-primary:hover:not(:disabled) { background: var(--accent-600); transform: translateY(-1px); box-shadow: var(--shadow-md); }
  .btn-primary:active:not(:disabled) { transform: translateY(0); }
  .btn-primary:disabled { opacity: .4; cursor: not-allowed; }
  .btn-secondary { background: var(--bg); color: var(--text); border: 2px solid var(--border); box-shadow: var(--shadow-sm); }
  .btn-secondary:hover { border-color: var(--border-strong); box-shadow: var(--shadow-md); }
  .hint { color: var(--muted); font-size: .92rem; margin-top: 10px; font-weight: 500; }

  .privacy-text { background: var(--panel); border: 1px solid var(--border); border-radius: 12px; padding: 18px; color: var(--muted); font-size: .98rem; line-height: 1.7; margin: 0 0 20px; max-height: 220px; overflow: auto; }
  .privacy-text strong { color: var(--text); }

  .completion-screen { text-align: center; color: var(--text); animation: fadeIn .5s ease; }
  .completion-screen h2 { font-size: 2.2rem; margin: 8px 0 10px; font-weight: 900; }
  .completion-screen .subtitle { font-size: 1.05rem; margin: 0 0 22px; }

  .results { background: var(--bg); border: 1px solid var(--border); border-radius: 14px; padding: 22px; margin-top: 16px; text-align: left; box-shadow: var(--shadow-sm); }
  .result-item { padding: 14px 0; border-bottom: 1px solid var(--border); }
  .result-item:last-child { border-bottom: none; }
  .result-label { font-weight: 700; margin-bottom: 6px; color: var(--muted); font-size: .9rem; letter-spacing: .01em; }
  .result-value { font-size: 1.02rem; color: var(--text); font-weight: 700; }

  .alert-box { background: var(--panel); border: 2px solid var(--border); border-radius: 12px; padding: 18px; margin: 20px 0; display: flex; align-items: start; gap: 14px; }
  .alert-box.warning { background: rgba(251, 191, 36, 0.1); border-color: #fbbf24; }
  .alert-box svg { width: 24px; height: 24px; flex-shrink: 0; stroke: #fbbf24; fill: none; stroke-width: 2; }
  .alert-box-content { flex: 1; }
  .alert-box-title { font-weight: 700; margin-bottom: 4px; color: var(--text); }
  .alert-box-text { color: var(--muted); font-size: .95rem; line-height: 1.6; }

  @keyframes fadeIn { from { opacity: 0; transform: scale(0.98); } to { opacity: 1; transform: scale(1); } }

  .privacy-text::-webkit-scrollbar { width: 8px; }
  .privacy-text::-webkit-scrollbar-track { background: var(--panel-strong); border-radius: 6px; }
  .privacy-text::-webkit-scrollbar-thumb { background: var(--accent); border-radius: 6px; }

  .sr-only { position: absolute; width: 1px; height: 1px; padding: 0; margin: -1px; overflow: hidden; clip: rect(0, 0, 0, 0); white-space: nowrap; border-width: 0; }

  @media (max-width: 768px) {
    .question { font-size: 1.6rem; }
    .subtitle { font-size: 1rem; }
    .input-field { font-size: 1rem; }
    .option, .checkbox-option { font-size: 1rem; padding: 16px 18px; }
    .theme-toggle { width: 44px; height: 44px; top: 16px; right: 16px; }
  }
</style>
</head>
<body>
  <button class="theme-toggle" type="button" onclick="toggleTheme()" aria-label="åˆ‡æ›æ·±è‰²/æ·ºè‰²ä¸»é¡Œ">
    <svg class="sun-icon" viewBox="0 0 24 24"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg>
    <svg class="moon-icon" viewBox="0 0 24 24"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/></svg>
  </button>

  <div class="particles-container" id="particles"></div>
  <div class="progress-bar" id="progressBar" role="progressbar" aria-valuemin="0" aria-valuemax="100" aria-valuenow="0"></div>

  <div class="container">
    <div class="question-container active" id="q0">
      <div class="hero-icon" aria-hidden="true"><svg viewBox="0 0 24 24"><path d="M12 2 2 7l10 5 10-5-10-5z"/><path d="M2 17l10 5 10-5"/><path d="M2 12l10 5 10-5"/></svg></div>
      <h1 class="question">å•Ÿå‹•æˆé•·æ–°å¼•æ“ï¼šåŠ å…¥å•†å®¶å›é¥‹è¯ç›Ÿ</h1>
      <p class="subtitle"><strong>ç‚ºé¡§å®¢å‰µé€ æ›´æµæš¢çš„é«”é©—,åŒæ™‚è³ºå–é«˜é¡å›é¥‹ã€‚</strong><br/>é€™ä¸åƒ…æ˜¯ä¸€ä»½å•å·,æ›´æ˜¯ç™¼æ˜ç„¡é™å•†æ©Ÿçš„èµ·é»ã€‚<br/><br/><strong>é è¨ˆå¡«å¯«æ™‚é–“:åƒ…éœ€ 3 åˆ†é˜</strong></p>
      <div class="controls">
        <button class="btn btn-primary" type="button" onclick="nextQuestion(0)"><span>ç«‹å³æ¢ç´¢åˆä½œæ©Ÿæœƒ</span><span>â†’</span></button>
      </div>
    </div>

    <div class="question-container" id="q1">
      <div class="question-number">ç¬¬ 1 æ­¥</div>
      <h1 class="question">ç¬¬ä¸€æ­¥,è®“æˆ‘å€‘èªè­˜æ‚¨ã€‚æ‚¨çš„å•†å‹™è¯çµ¡ä¿¡ç®±æ˜¯?</h1>
      <input type="email" class="input-field" id="email" placeholder="example@email.com" autocomplete="email" inputmode="email" autocapitalize="none" autocorrect="off" aria-describedby="email-hint email-error"/>
      <p class="hint" id="email-hint">è¼¸å…¥æœ‰æ•ˆä¿¡ç®±å¾Œå³å¯å‰å¾€ä¸‹ä¸€æ­¥(è‡ªå‹•è½‰æ›å…¨å½¢å­—å…ƒèˆ‡ç§»é™¤éš±è—ç©ºç™½)ã€‚</p>
      <p class="error-message" id="email-error">è«‹è¼¸å…¥æœ‰æ•ˆçš„é›»å­éƒµä»¶åœ°å€</p>
      <div class="controls">
        <button class="btn btn-secondary" type="button" onclick="prevQuestion(1)"><span>â†</span><span>è¿”å›</span></button>
        <button class="btn btn-primary" type="button" onclick="nextQuestion(1)" disabled id="btn1"><span>ä¸‹ä¸€æ­¥</span><span>â†’</span></button>
      </div>
    </div>

    <div class="question-container" id="q2">
      <div class="question-number">ç¬¬ 2 æ­¥</div>
      <h1 class="question">è²´å…¬å¸çš„å¯¶è™Ÿæ˜¯?</h1>
      <input type="text" class="input-field" id="businessName" placeholder="è«‹è¼¸å…¥å®Œæ•´å•†å®¶åç¨±" autocomplete="organization" aria-describedby="business-hint"/>
      <p class="hint" id="business-hint">è®“æˆ‘å€‘çŸ¥é“è©²å¦‚ä½•ç¨±å‘¼æ‚¨ã€‚</p>
      <div class="controls">
        <button class="btn btn-secondary" type="button" onclick="prevQuestion(2)"><span>â†</span><span>ä¸Šä¸€æ­¥</span></button>
        <button class="btn btn-primary" type="button" onclick="nextQuestion(2)" disabled id="btn2"><span>ä¸‹ä¸€æ­¥</span><span>â†’</span></button>
      </div>
    </div>

    <div class="question-container" id="q3">
      <div class="question-number">ç¬¬ 3 æ­¥</div>
      <h1 class="question">å€‹äººè³‡æ–™ä½¿ç”¨åŒæ„</h1>
      <div class="privacy-text" role="region" aria-label="å€‹è³‡èªªæ˜" tabindex="0">
        <p><strong>å€‹äººè³‡æ–™è’é›†ã€è™•ç†åŠåˆ©ç”¨å‘ŠçŸ¥äº‹é …</strong></p><br/>
        <p>ç‚ºæä¾›æ‚¨æ›´å®Œå–„çš„æœå‹™,æˆ‘å€‘éœ€è¦è’é›†æ‚¨çš„å€‹äººè³‡æ–™ã€‚æ‚¨æ‰€æä¾›çš„å€‹äººè³‡æ–™,å°‡ä¾æ“šå€‹äººè³‡æ–™ä¿è­·æ³•åŠç›¸é—œæ³•ä»¤è¦å®š,åƒ…ç”¨æ–¼ä»¥ä¸‹ç›®çš„:</p><br/>
        <ul style="padding-left: 20px;"><li>åˆä½œå¤¥ä¼´é—œä¿‚å»ºç«‹èˆ‡ç¶­è­·</li><li>å•†æ¥­æœå‹™è«®è©¢èˆ‡æ¨å»£</li><li>å®¢æˆ¶ç®¡ç†èˆ‡æœå‹™</li><li>è¡ŒéŠ·æ¥­å‹™(åŒ…å«ä½†ä¸é™æ–¼å»£å‘Šè¡ŒéŠ·ã€å•å·èª¿æŸ¥ç­‰)</li></ul><br/>
        <p>æ‚¨å¯ä»¥é¸æ“‡æ˜¯å¦æä¾›å€‹äººè³‡æ–™,è‹¥æ‚¨é¸æ“‡ä¸æä¾›,å¯èƒ½å½±éŸ¿æ‚¨åƒèˆ‡æœ¬è¨ˆç•«çš„æ¬Šç›Šã€‚</p>
      </div>
      <div class="options" role="radiogroup" aria-label="å€‹äººè³‡æ–™ä½¿ç”¨åŒæ„">
        <label class="option"><input type="radio" name="privacyConsent" value="åŒæ„" class="sr-only" onchange="handlePrivacyChange(this)"><span class="option-letter">âœ“</span><span>æˆ‘åŒæ„ä»¥ä¸Šå€‹äººè³‡æ–™ä½¿ç”¨æ¢æ¬¾</span></label>
        <label class="option"><input type="radio" name="privacyConsent" value="ä¸åŒæ„" class="sr-only" onchange="handlePrivacyChange(this)"><span class="option-letter">âœ—</span><span>æˆ‘ä¸åŒæ„</span></label>
      </div>
      <div class="controls"><button class="btn btn-secondary" type="button" onclick="prevQuestion(3)"><span>â†</span><span>ä¸Šä¸€æ­¥</span></button></div>
    </div>

    <div class="question-container" id="q3-reject">
      <div class="alert-box warning">
        <svg viewBox="0 0 24 24"><path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"/><line x1="12" y1="9" x2="12" y2="13"/><line x1="12" y1="17" x2="12.01" y2="17"/></svg>
        <div class="alert-box-content">
          <div class="alert-box-title">ç„¡æ³•ç¹¼çºŒå•å·</div>
          <div class="alert-box-text">å¾ˆæŠ±æ­‰,æˆ‘å€‘éœ€è¦æ‚¨åŒæ„å€‹äººè³‡æ–™ä½¿ç”¨æ¢æ¬¾æ‰èƒ½ç¹¼çºŒã€‚é€™æ˜¯ç‚ºäº†ç¢ºä¿æˆ‘å€‘èƒ½å¤ åˆæ³•ä¸”å®‰å…¨åœ°è™•ç†æ‚¨çš„è³‡æ–™,ç‚ºæ‚¨æä¾›æœ€ä½³æœå‹™ã€‚</div>
        </div>
      </div>
      <div class="controls">
        <button class="btn btn-secondary" type="button" onclick="showCard('q3', 'q3-reject')"><span>â†</span><span>é‡æ–°è€ƒæ…®</span></button>
        <button class="btn btn-primary" type="button" onclick="showCard('q0', 'q3-reject')"><span>è¿”å›é¦–é </span></button>
      </div>
    </div>

    <div class="question-container" id="q4">
      <div class="question-number">ç¬¬ 4 æ­¥</div>
      <h1 class="question">æ‚¨å°ã€Œå•†å®¶å›é¥‹è¯ç›Ÿã€çš„ç¬¬ä¸€å°è±¡å¦‚ä½•?</h1>
      <div class="options" role="radiogroup" aria-label="åˆä½œæ„å‘">
        <label class="option"><input type="radio" name="intention" value="interested" class="sr-only" onchange="handleIntentionChange(this)"><span class="option-letter">A</span><span>è½èµ·ä¾†å¾ˆæ£’!æˆ‘æƒ³æ·±å…¥äº†è§£åˆä½œç´°ç¯€ã€‚</span></label>
        <label class="option"><input type="radio" name="intention" value="more-info" class="sr-only" onchange="handleIntentionChange(this)"><span class="option-letter">B</span><span>æˆ‘æƒ³èˆ‡å°ˆäººèŠèŠ,å®¢è£½æœ€é©åˆæˆ‘çš„æ–¹æ¡ˆã€‚</span></label>
        <label class="option"><input type="radio" name="intention" value="not-interested" class="sr-only" onchange="handleIntentionChange(this)"><span class="option-letter">C</span><span>æš«ä¸è€ƒæ…®,ä½†æˆ‘é¡˜æ„åˆ†äº«ä¸€äº›æƒ³æ³•ã€‚</span></label>
      </div>
      <div class="controls"><button class="btn btn-secondary" type="button" onclick="prevQuestion(4)"><span>â†</span><span>ä¸Šä¸€æ­¥</span></button></div>
    </div>

    <div class="question-container" id="q5">
      <div class="question-number">ç¬¬ 5 æ­¥</div>
      <h1 class="question">æˆ‘å€‘è©²å¦‚ä½•ç¨±å‘¼æ‚¨?</h1>
      <input type="text" class="input-field" id="contactName" placeholder="è«‹è¼¸å…¥æ‚¨çš„å§“å" autocomplete="name" aria-describedby="name-hint"/>
      <p class="hint" id="name-hint">è«‹æä¾›æ‚¨çš„çœŸå¯¦å§“å,ä»¥ä¾¿æˆ‘å€‘æ›´å¥½åœ°ç‚ºæ‚¨æœå‹™ã€‚</p>
      <div class="controls">
        <button class="btn btn-secondary" type="button" onclick="prevQuestion(5)"><span>â†</span><span>ä¸Šä¸€æ­¥</span></button>
        <button class="btn btn-primary" type="button" onclick="nextQuestion(5)" disabled id="btn5"><span>ä¸‹ä¸€æ­¥</span><span>â†’</span></button>
      </div>
    </div>

    <div class="question-container" id="q6">
      <div class="question-number">ç¬¬ 6 æ­¥</div>
      <h1 class="question">è«‹ç•™ä¸‹æ‚¨çš„è¯çµ¡é›»è©±</h1>
      <input type="tel" class="input-field" id="contactPhone" placeholder="09XX-XXX-XXX" autocomplete="tel" inputmode="tel" aria-describedby="phone-hint phone-error"/>
      <p class="hint" id="phone-hint">åˆä½œé¡§å•å°‡ç›¡é€Ÿèˆ‡æ‚¨è¯ç¹«,é–‹å•Ÿé›™è´å¥‘æ©Ÿã€‚</p>
      <p class="error-message" id="phone-error">è«‹è¼¸å…¥æœ‰æ•ˆçš„å°ç£æ‰‹æ©Ÿè™Ÿç¢¼(09é–‹é ­,10ç¢¼)</p>
      <div class="controls">
        <button class="btn btn-secondary" type="button" onclick="prevQuestion(6)"><span>â†</span><span>ä¸Šä¸€æ­¥</span></button>
        <button class="btn btn-primary" type="button" onclick="nextQuestion(6)" disabled id="btn6"><span>ä¸‹ä¸€æ­¥</span><span>â†’</span></button>
      </div>
    </div>

    <div class="question-container" id="q7">
      <div class="question-number">ç¬¬ 7 æ­¥</div>
      <h1 class="question">å¾ˆé«˜èˆˆæ‚¨æ‰¾åˆ°äº†æˆ‘å€‘!æ‚¨æ˜¯å¾å“ªè£¡å¾—çŸ¥æ­¤è¨ˆç•«?</h1>
      <div class="checkbox-group" role="group" aria-label="è³‡è¨Šä¾†æº">
        <label class="checkbox-option"><input type="checkbox" name="infoSource" value="Facebook å»£å‘Š" class="sr-only" onchange="handleCheckboxChange(this)"><div class="checkbox-box"></div><span>Facebook å»£å‘Š</span></label>
        <label class="checkbox-option"><input type="checkbox" name="infoSource" value="Google æœå°‹" class="sr-only" onchange="handleCheckboxChange(this)"><div class="checkbox-box"></div><span>Google æœå°‹</span></label>
        <label class="checkbox-option"><input type="checkbox" name="infoSource" value="Instagram" class="sr-only" onchange="handleCheckboxChange(this)"><div class="checkbox-box"></div><span>Instagram</span></label>
        <label class="checkbox-option"><input type="checkbox" name="infoSource" value="æœ‹å‹æ¨è–¦" class="sr-only" onchange="handleCheckboxChange(this)"><div class="checkbox-box"></div><span>æœ‹å‹æ¨è–¦</span></label>
        <label class="checkbox-option"><input type="checkbox" name="infoSource" value="Email é€šçŸ¥" class="sr-only" onchange="handleCheckboxChange(this)"><div class="checkbox-box"></div><span>Email é€šçŸ¥</span></label>
        <label class="checkbox-option"><input type="checkbox" name="infoSource" value="å®˜æ–¹ç¶²ç«™" class="sr-only" onchange="handleCheckboxChange(this)"><div class="checkbox-box"></div><span>å®˜æ–¹ç¶²ç«™</span></label>
        <label class="checkbox-option"><input type="checkbox" name="infoSource" value="å…¶ä»–" class="sr-only" onchange="handleCheckboxChange(this)"><div class="checkbox-box"></div><span>å…¶ä»–</span></label>
      </div>
      <p class="hint">å¯è¤‡é¸,å¹«åŠ©æˆ‘å€‘äº†è§£æœ€æœ‰æ•ˆçš„æ¨å»£ç®¡é“ã€‚</p>
      <div class="controls">
        <button class="btn btn-secondary" type="button" onclick="prevQuestion(7)"><span>â†</span><span>ä¸Šä¸€æ­¥</span></button>
        <button class="btn btn-primary" type="button" onclick="nextQuestion(7)" disabled id="btn7"><span>ä¸‹ä¸€æ­¥</span><span>â†’</span></button>
      </div>
    </div>

    <div class="question-container" id="q8">
      <div class="question-number">ç¬¬ 8 æ­¥</div>
      <h1 class="question">æ‚¨çš„æ¨è–¦æ„é¡˜èª¿æŸ¥</h1>
      <p class="subtitle">æ‚¨æ˜¯å¦é¡˜æ„å°‡æœ¬è¨ˆç•«æ¨è–¦çµ¦å…¶ä»–å•†æ¥­å¤¥ä¼´?</p>
      <div class="options" role="radiogroup" aria-label="æ¨è–¦æ„é¡˜">
        <label class="option"><input type="radio" name="referral" value="éå¸¸é¡˜æ„" class="sr-only" onchange="handleOptionChange(this, 8, true)"><span class="option-letter">A</span><span>éå¸¸é¡˜æ„ - æˆ‘æœƒç©æ¥µæ¨è–¦</span></label>
        <label class="option"><input type="radio" name="referral" value="é¡˜æ„" class="sr-only" onchange="handleOptionChange(this, 8, true)"><span class="option-letter">B</span><span>é¡˜æ„ - å¦‚æœæœ‰æ©Ÿæœƒæœƒæ¨è–¦</span></label>
        <label class="option"><input type="radio" name="referral" value="ä¸­ç«‹" class="sr-only" onchange="handleOptionChange(this, 8, true)"><span class="option-letter">C</span><span>ä¸­ç«‹ - è¦–æƒ…æ³è€Œå®š</span></label>
        <label class="option"><input type="radio" name="referral" value="ä¸å¤ªé¡˜æ„" class="sr-only" onchange="handleOptionChange(this, 8, true)"><span class="option-letter">D</span><span>ä¸å¤ªé¡˜æ„</span></label>
      </div>
      <div class="controls"><button class="btn btn-secondary" type="button" onclick="prevQuestion(8)"><span>â†</span><span>ä¸Šä¸€æ­¥</span></button></div>
    </div>

    <div class="question-container" id="q9">
      <div class="question-number">æœ€å¾Œä¸€æ­¥</div>
      <h1 class="question">æ‚¨çš„å¯¶è²´æ„è¦‹,æ˜¯æˆ‘å€‘é€²æ­¥çš„å‹•åŠ›ã€‚</h1>
      <p class="subtitle">è«‹å•æ‚¨æš«ä¸è€ƒæ…®çš„ä¸»è¦åŸå› æ˜¯?</p>
      <div class="options" role="radiogroup" aria-label="ä¸è€ƒæ…®åŸå› ">
        <label class="option"><input type="radio" name="notInterested" value="å·²æœ‰åˆä½œå°è±¡" class="sr-only" onchange="handleOptionChange(this, 9, true)"><span class="option-letter">A</span><span>å·²æœ‰åˆä½œå°è±¡</span></label>
        <label class="option"><input type="radio" name="notInterested" value="ä¸ç¬¦åˆç‡Ÿæ¥­éœ€æ±‚" class="sr-only" onchange="handleOptionChange(this, 9, true)"><span class="option-letter">B</span><span>ä¸ç¬¦åˆç‡Ÿæ¥­éœ€æ±‚</span></label>
        <label class="option"><input type="radio" name="notInterested" value="è²»ç”¨è€ƒé‡" class="sr-only" onchange="handleOptionChange(this, 9, true)"><span class="option-letter">C</span><span>è²»ç”¨è€ƒé‡</span></label>
        <label class="option"><input type="radio" name="notInterested" value="ç›®å‰æ™‚é–“ä¸åˆé©" class="sr-only" onchange="handleOptionChange(this, 9, true)"><span class="option-letter">D</span><span>ç›®å‰æ™‚é–“ä¸åˆé©</span></label>
        <label class="option"><input type="radio" name="notInterested" value="ä¸äº†è§£æœå‹™å…§å®¹" class="sr-only" onchange="handleOptionChange(this, 9, true)"><span class="option-letter">E</span><span>ä¸äº†è§£æœå‹™å…§å®¹</span></label>
        <label class="option"><input type="radio" name="notInterested" value="å…¶ä»–åŸå› " class="sr-only" onchange="handleOptionChange(this, 9, true)"><span class="option-letter">F</span><span>å…¶ä»–åŸå› </span></label>
      </div>
      <div class="controls"><button class="btn btn-secondary" type="button" onclick="prevQuestion(9)"><span>â†</span><span>ä¸Šä¸€æ­¥</span></button></div>
    </div>

    <div class="question-container" id="completionMoreInfo">
      <div class="completion-screen">
        <div class="hero-icon"><svg viewBox="0 0 24 24"><path d="M16 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/><circle cx="8.5" cy="7" r="4"/><path d="M20 8v6M23 11h-6"/></svg></div>
        <h2>åˆä½œçš„æ—…ç¨‹,å³å°‡å•Ÿç¨‹!</h2>
        <p class="subtitle"><strong>æ„Ÿè¬æ‚¨è¸å‡ºç¬¬ä¸€æ­¥!</strong><br/>æˆ‘å€‘çš„åˆä½œé¡§å•æ­£åœ¨ç‚ºæ‚¨æº–å‚™å°ˆå±¬çš„åˆä½œè—åœ–,é è¨ˆ 1â€“2 å€‹å·¥ä½œå¤©å…§èˆ‡æ‚¨è¯ç¹«ã€‚</p>
        <div class="results" id="resultsMoreInfo"></div>
      </div>
    </div>

    <div class="question-container" id="completion">
      <div class="completion-screen">
        <div class="hero-icon"><svg viewBox="0 0 24 24"><polyline points="20 6 9 17 4 12"/></svg></div>
        <h2>æ„Ÿè¬æ‚¨çš„å¯¶è²´å›é¥‹!</h2>
        <p class="subtitle">æ‚¨çš„æ„è¦‹å°æˆ‘å€‘è‡³é—œé‡è¦,æ˜¯æˆ‘å€‘æŒçºŒå„ªåŒ–æœå‹™çš„åŸºçŸ³ã€‚</p>
        <div class="results" id="results"></div>
      </div>
    </div>
  </div>

<script>
(function() {
  'use strict';

  // ===== ä¸»é¡Œç®¡ç† =====
  (function initTheme() {
    try {
      const saved = localStorage.getItem('theme');
      if (saved) {
        document.documentElement.setAttribute('data-theme', saved);
      } else if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.documentElement.setAttribute('data-theme', 'dark');
      }
    } catch(e) {
      console.warn('Theme initialization error:', e);
    }
  })();

  window.toggleTheme = function() {
    const root = document.documentElement;
    const isDark = root.getAttribute('data-theme') === 'dark';
    const next = isDark ? '' : 'dark';
    if (next) {
      root.setAttribute('data-theme', next);
    } else {
      root.removeAttribute('data-theme');
    }
    try {
      localStorage.setItem('theme', next);
    } catch(e) {
      console.warn('Theme save error:', e);
    }
  };

  // ===== DOM Ready =====
  document.addEventListener('DOMContentLoaded', function() {
    // èƒŒæ™¯ç²’å­
    (function createParticles() {
      const container = document.getElementById('particles');
      const count = 36;
      for (let i = 0; i < count; i++) {
        const p = document.createElement('div');
        p.className = 'particle';
        p.style.left = Math.random() * 100 + '%';
        p.style.bottom = Math.random() * 100 + 'vh';
        p.style.animationDelay = (Math.random() * 18) + 's';
        p.style.animationDuration = (14 + Math.random() * 10) + 's';
        container.appendChild(p);
      }
    })();

    // ===== å•å·ç‹€æ…‹ç®¡ç† =====
    const state = {
      currentStep: 0,
      totalSteps: 0,
      userPath: '',
      answers: {
        email: '',
        businessName: '',
        privacyConsent: '',
        intention: '',
        contactName: '',
        contactPhone: '',
        infoSources: new Set(),
        referralWillingness: '',
        notInterestedReason: ''
      }
    };

    // å„è·¯å¾‘çš„æ­¥é©Ÿæ˜ å°„
    const pathSteps = {
      interested: [0, 1, 2, 3, 4, 5, 6, 7, 8],  // 9æ­¥
      'more-info': [0, 1, 2, 3, 4],  // 5æ­¥
      'not-interested': [0, 1, 2, 3, 4, 9]  // 6æ­¥
    };

    // ===== é€²åº¦æ¢ç®¡ç† =====
    function updateProgress() {
      if (state.totalSteps === 0) {
        setProgressBar(0);
        return;
      }
      
      let currentIndex = 0;
      if (state.userPath && pathSteps[state.userPath]) {
        currentIndex = pathSteps[state.userPath].indexOf(state.currentStep);
        if (currentIndex === -1) currentIndex = 0;
      }
      
      const percent = (currentIndex / (state.totalSteps - 1)) * 100;
      setProgressBar(Math.min(100, Math.max(0, percent)));
    }

    function setProgressBar(percent) {
      const bar = document.getElementById('progressBar');
      bar.style.width = percent + '%';
      bar.setAttribute('aria-valuenow', Math.round(percent));
    }

    // ===== å¡ç‰‡åˆ‡æ› =====
    window.showCard = function(nextId, currentId) {
      const currentCard = document.getElementById(currentId);
      if (currentCard) {
        currentCard.classList.remove('active');
      }
      
      setTimeout(() => {
        const nextCard = document.getElementById(nextId);
        if (nextCard) {
          nextCard.classList.add('active');
          
          // æ›´æ–°ç•¶å‰æ­¥é©Ÿ
          const stepNum = parseInt(nextId.replace('q', ''));
          if (!isNaN(stepNum)) {
            state.currentStep = stepNum;
            updateProgress();
          }
          
          // èšç„¦åˆ°ç¬¬ä¸€å€‹å¯èšç„¦å…ƒç´ 
          const focusable = nextCard.querySelector('input, button, [tabindex]:not([tabindex="-1"])');
          if (focusable) {
            setTimeout(() => focusable.focus(), 100);
          }
        }
      }, 220);
    };

    // ===== å°èˆªå‡½æ•¸ =====
    window.nextQuestion = function(current) {
      const currentId = 'q' + current;
      
      // ä¿å­˜ç­”æ¡ˆ
      if (current === 1) {
        state.answers.email = normalizeEmail(document.getElementById('email').value.trim());
      } else if (current === 2) {
        state.answers.businessName = document.getElementById('businessName').value.trim();
      } else if (current === 5) {
        state.answers.contactName = document.getElementById('contactName').value.trim();
      } else if (current === 6) {
        state.answers.contactPhone = document.getElementById('contactPhone').value.trim();
      } else if (current === 7) {
        // è³‡è¨Šä¾†æºå·²åœ¨ checkbox change æ™‚ä¿å­˜
      }
      
      showCard('q' + (current + 1), currentId);
    };

    window.prevQuestion = function(current) {
      const currentId = 'q' + current;
      let prevQ = current - 1;
      
      // ç‰¹æ®Šè·¯å¾‘è™•ç†
      if (current === 5 || current === 9) {
        prevQ = 4;
      }
      
      showCard('q' + prevQ, currentId);
    };

    // ===== éš±ç§åŒæ„è™•ç† =====
    window.handlePrivacyChange = function(radio) {
      const value = radio.value;
      const questionContainer = radio.closest('.question-container');
      
      // æ›´æ–°æ¨£å¼
      questionContainer.querySelectorAll('.option').forEach(label => {
        label.classList.remove('selected');
      });
      radio.parentElement.classList.add('selected');
      
      state.answers.privacyConsent = value;
      
      setTimeout(() => {
        if (value === 'åŒæ„') {
          nextQuestion(3);
        } else {
          // ä¸åŒæ„å‰‡é¡¯ç¤ºè­¦å‘Šé é¢
          showCard('q3-reject', 'q3');
        }
      }, 350);
    };

    // ===== æ„å‘åˆ†æµè™•ç† =====
    window.handleIntentionChange = function(radio) {
      const intention = radio.value;
      const questionContainer = radio.closest('.question-container');
      
      // æ›´æ–°æ¨£å¼
      questionContainer.querySelectorAll('.option').forEach(label => {
        label.classList.remove('selected');
      });
      radio.parentElement.classList.add('selected');
      
      state.userPath = intention;
      state.answers.intention = intention;
      
      setTimeout(() => {
        if (intention === 'interested') {
          state.totalSteps = 9;
          showCard('q5', 'q4');
        } else if (intention === 'more-info') {
          state.totalSteps = 5;
          showMoreInfoCompletion();
        } else if (intention === 'not-interested') {
          state.totalSteps = 6;
          showCard('q9', 'q4');
        }
      }, 350);
    };

    // ===== é¸é …è™•ç† =====
    window.handleOptionChange = function(radio, currentStep, isFinalStep = false) {
      const value = radio.value;
      const questionContainer = radio.closest('.question-container');
      
      // æ›´æ–°æ¨£å¼
      questionContainer.querySelectorAll('.option').forEach(label => {
        label.classList.remove('selected');
      });
      radio.parentElement.classList.add('selected');
      
      // ä¿å­˜ç­”æ¡ˆ
      const qid = questionContainer.id;
      if (qid === 'q8') {
        state.answers.referralWillingness = value;
      } else if (qid === 'q9') {
        state.answers.notInterestedReason = value;
      }
      
      // å»¶é²å¾ŒåŸ·è¡Œä¸‹ä¸€æ­¥
      setTimeout(() => {
        if (isFinalStep) {
          submitForm();
        } else {
          nextQuestion(currentStep);
        }
      }, 350);
    };

    // ===== è¤‡é¸æ¡†è™•ç† =====
    window.handleCheckboxChange = function(checkbox) {
      checkbox.parentElement.classList.toggle('selected');
      
      if (checkbox.checked) {
        state.answers.infoSources.add(checkbox.value);
      } else {
        state.answers.infoSources.delete(checkbox.value);
      }
      
      document.getElementById('btn7').disabled = (state.answers.infoSources.size === 0);
    };

    // ===== è¡¨å–®æäº¤ =====
    window.submitForm = function() {
      const currentCard = document.querySelector('.question-container.active');
      if (currentCard) {
        currentCard.classList.remove('active');
      }
      
      setTimeout(() => {
        displayResults();
        
        // ç™¼é€æ•¸æ“šåˆ°å¾Œç«¯ï¼ˆç¤ºä¾‹ï¼‰
        sendFormData();
        
        showCard('completion', 'q' + state.currentStep);
        state.currentStep = state.totalSteps;
        setProgressBar(100);
      }, 220);
    };

    // ===== ç™¼é€è¡¨å–®æ•¸æ“š =====
    function sendFormData() {
      const formData = {
        email: state.answers.email,
        businessName: state.answers.businessName,
        privacyConsent: state.answers.privacyConsent,
        intention: state.answers.intention,
        path: state.userPath,
        timestamp: new Date().toISOString()
      };
      
      // æ ¹æ“šè·¯å¾‘æ·»åŠ é¡å¤–è³‡æ–™
      if (state.userPath === 'interested') {
        formData.contactName = state.answers.contactName;
        formData.contactPhone = state.answers.contactPhone;
        formData.infoSources = Array.from(state.answers.infoSources);
        formData.referralWillingness = state.answers.referralWillingness;
      } else if (state.userPath === 'not-interested') {
        formData.notInterestedReason = state.answers.notInterestedReason;
      }
      
      // æ¨¡æ“¬ç™¼é€åˆ°å¾Œç«¯
      console.log('ğŸ“¤ æäº¤è¡¨å–®æ•¸æ“š:', formData);
      
      // å¯¦éš›å¯¦ä½œæ™‚,å–æ¶ˆè¨»è§£ä»¥ä¸‹ä»£ç¢¼:
      /*
      fetch('/api/submit-survey', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify(formData)
      })
      .then(response => response.json())
      .then(data => {
        console.log('âœ… æäº¤æˆåŠŸ:', data);
      })
      .catch(error => {
        console.error('âŒ æäº¤å¤±æ•—:', error);
      });
      */
    }

    // ===== é¡¯ç¤º more-info å®Œæˆé  =====
    function showMoreInfoCompletion() {
      showCard('completionMoreInfo', 'q4');
      
      const html = `
        <div class="result-item">
          <div class="result-label">å•†å‹™è¯çµ¡ä¿¡ç®±</div>
          <div class="result-value">${escapeHtml(state.answers.email)}</div>
        </div>
        <div class="result-item">
          <div class="result-label">å•†å®¶åç¨±</div>
          <div class="result-value">${escapeHtml(state.answers.businessName)}</div>
        </div>
        <div class="result-item">
          <div class="result-label">åˆä½œæ„å‘</div>
          <div class="result-value">å¸Œæœ›èˆ‡å°ˆäººæ´½è«‡</div>
        </div>`;
      
      document.getElementById('resultsMoreInfo').innerHTML = html;
      
      // ç™¼é€æ•¸æ“š
      sendFormData();
      
      // è¨­ç½®é€²åº¦ç‚º100%
      state.currentStep = state.totalSteps;
      setProgressBar(100);
    }

    // ===== é¡¯ç¤ºå®Œæˆçµæœ =====
    function displayResults() {
      const infoSourcesText = state.answers.infoSources.size > 0 
        ? Array.from(state.answers.infoSources).map(escapeHtml).join(', ') 
        : 'æœªæä¾›';
      
      let html = `
        <div class="result-item">
          <div class="result-label">å•†å‹™è¯çµ¡ä¿¡ç®±</div>
          <div class="result-value">${escapeHtml(state.answers.email)}</div>
        </div>
        <div class="result-item">
          <div class="result-label">å•†å®¶åç¨±</div>
          <div class="result-value">${escapeHtml(state.answers.businessName)}</div>
        </div>
        <div class="result-item">
          <div class="result-label">å€‹äººè³‡æ–™ä½¿ç”¨åŒæ„</div>
          <div class="result-value">${escapeHtml(state.answers.privacyConsent)}</div>
        </div>`;
      
      if (state.userPath === 'interested') {
        html += `
          <div class="result-item">
            <div class="result-label">è¯çµ¡äººå§“å</div>
            <div class="result-value">${escapeHtml(state.answers.contactName)}</div>
          </div>
          <div class="result-item">
            <div class="result-label">è¯çµ¡é›»è©±</div>
            <div class="result-value">${escapeHtml(state.answers.contactPhone)}</div>
          </div>
          <div class="result-item">
            <div class="result-label">æ´»å‹•è³‡è¨Šä¾†æº</div>
            <div class="result-value">${infoSourcesText}</div>
          </div>
          <div class="result-item">
            <div class="result-label">æ¨è–¦æ„é¡˜</div>
            <div class="result-value">${escapeHtml(state.answers.referralWillingness)}</div>
          </div>`;
      } else if (state.userPath === 'not-interested') {
        html += `
          <div class="result-item">
            <div class="result-label">æš«ä¸è€ƒæ…®åŸå› </div>
            <div class="result-value">${escapeHtml(state.answers.notInterestedReason)}</div>
          </div>`;
      }
      
      document.getElementById('results').innerHTML = html;
    }

    // ===== Email é©—è­‰ =====
    const emailEl = document.getElementById('email');
    const emailError = document.getElementById('email-error');
    const btn1 = document.getElementById('btn1');
    
    emailEl.addEventListener('input', function() {
      const normalized = normalizeEmail(this.value);
      const isValid = validateEmail(normalized);
      
      btn1.disabled = !isValid;
      
      if (this.value.length > 0) {
        if (!isValid) {
          this.classList.add('invalid');
          emailError.classList.add('visible');
        } else {
          this.classList.remove('invalid');
          emailError.classList.remove('visible');
        }
      } else {
        this.classList.remove('invalid');
        emailError.classList.remove('visible');
      }
    });
    
    emailEl.addEventListener('keypress', e => {
      if (e.key === 'Enter' && !btn1.disabled) {
        nextQuestion(1);
      }
    });

    // ===== å•†å®¶åç¨±é©—è­‰ =====
    const businessNameEl = document.getElementById('businessName');
    const btn2 = document.getElementById('btn2');
    
    businessNameEl.addEventListener('input', function() {
      btn2.disabled = this.value.trim().length < 2;
    });
    
    businessNameEl.addEventListener('keypress', e => {
      if (e.key === 'Enter' && !btn2.disabled) {
        nextQuestion(2);
      }
    });

    // ===== è¯çµ¡äººé©—è­‰ =====
    const contactNameEl = document.getElementById('contactName');
    const btn5 = document.getElementById('btn5');
    
    contactNameEl.addEventListener('input', function() {
      btn5.disabled = this.value.trim().length < 2;
    });
    
    contactNameEl.addEventListener('keypress', e => {
      if (e.key === 'Enter' && !btn5.disabled) {
        nextQuestion(5);
      }
    });

    // ===== é›»è©±é©—è­‰ =====
    const contactPhoneEl = document.getElementById('contactPhone');
    const phoneError = document.getElementById('phone-error');
    const btn6 = document.getElementById('btn6');
    
    contactPhoneEl.addEventListener('input', function() {
      const phone = this.value.replace(/\D/g, '');
      const isValid = validatePhone(phone);
      
      btn6.disabled = !isValid;
      
      if (this.value.length > 0) {
        if (!isValid && phone.length > 0) {
          this.classList.add('invalid');
          phoneError.classList.add('visible');
        } else {
          this.classList.remove('invalid');
          phoneError.classList.remove('visible');
        }
      } else {
        this.classList.remove('invalid');
        phoneError.classList.remove('visible');
      }
    });
    
    contactPhoneEl.addEventListener('keypress', e => {
      if (e.key === 'Enter' && !btn6.disabled) {
        nextQuestion(6);
      }
    });

    // ===== å·¥å…·å‡½æ•¸ =====
    function normalizeEmail(value) {
      if (!value) return value;
      
      // å…¨å½¢è½‰åŠå½¢
      let normalized = value.replace(/[\uFF01-\uFF5E]/g, ch => 
        String.fromCharCode(ch.charCodeAt(0) - 0xFEE0)
      );
      
      // å…¨å½¢ç©ºæ ¼è½‰åŠå½¢
      normalized = normalized.replace(/\u3000/g, ' ');
      
      // ç§»é™¤æ‰€æœ‰ç©ºç™½
      normalized = normalized.replace(/\s+/g, '');
      
      return normalized.toLowerCase();
    }

    function validateEmail(email) {
      const re = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
      return re.test(email);
    }

    function validatePhone(phone) {
      // å°ç£æ‰‹æ©Ÿæ ¼å¼: 09é–‹é ­,10ç¢¼
      return /^09\d{8}$/.test(phone);
    }

    function escapeHtml(str) {
      const map = {
        '&': '&amp;',
        '<': '&lt;',
        '>': '&gt;',
        '"': '&quot;',
        "'": '&#39;',
        '/': '&#x2F;',
        '`': '&#x60;',
        '=': '&#x3D;'
      };
      return String(str).replace(/[&<>"'`=\/]/g, s => map[s]);
    }

    // ===== åˆå§‹åŒ– =====
    updateProgress();
  });
})();
</script>
</body>
</html>